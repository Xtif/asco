<!DOCTYPE html>
<html>

  <head>
      <meta charset="UTF-8" />
      <title>Parcelles cadastrales Asco</title>

      <link rel="icon" type="image/x-icon" href="drapeau_corse.jpg" />
      
      <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

      <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
      <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.bundle.min.js" integrity="sha384-feJI7QwhOS+hwpX2zkaeJQjeiwlhOP+SdQDqhgvvo1DsjtiSQByFdThsxO669S2D" crossorigin="anonymous"></script>

      <style>
        /* Always set the map height explicitly to define the size of the div
         * element that contains the map. */
        #map {
          height: 100%;
        }

        .div-map {
          height: 90vh;
        }

        /* Optional: Makes the sample page fill the window. */
        html, body {
          height: 100%;
          margin: 0;
          padding: 0;
        }

        h1 {
          color: white;
        }

        h5 {
          font-size: 15px;
        }

        h6, p, a {
          font-size: 13px;
        }

        .card {
          margin-bottom: 5px;
        }
      </style>
  </head>

  <header class="text-center pt-2 pb-2 bg-info">
    <h1 class="m-auto">PARCELLES CADASTRALES ASCO</h1>
  </header>

  <body>
    <div class="row m-3">

      <div class="col-sm-3 pr-0">
        <h4 class="mb-3">Liste des parcelles :</h4>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle A368</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Rupiana</h6>
            <p class="card-text m-0">Superficie : 1ha 64a 32ca</p>
            <a href="#" id="0" class="card-link zoom">Zoomer sur la carte</a>
            <a href="A368.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle B183</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : L'Orzale</h6>
            <p class="card-text m-0">Superficie : 49a 21ca</p>
            <a href="#" id="1" class="card-link zoom">Zoomer sur la carte</a>
            <a href="B183.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle B355 et B356</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : L'Erzale</h6>
            <p class="card-text m-0">Superficie B355 & B356 : 82a 97ca + 24ca</p>
            <a href="#" id="2" class="card-link zoom">Zoomer sur la carte</a>
            <a href="B355_356.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle B364</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Scolca</h6>
            <p class="card-text m-0">Superficie : 42a 82ca</p>
            <a href="#" id="3" class="card-link zoom">Zoomer sur la carte</a>
            <a href="B364.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C43</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Piano</h6>
            <p class="card-text m-0">Superficie : 83a 93ca</p>
            <a href="#" id="4" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C43.gpx#" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C53</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Piano</h6>
            <p class="card-text m-0">Superficie : 3ha 62a 16ca</p>
            <a href="#" id="5" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C53.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C62 & C63</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Rado alle Volte</h6>
            <p class="card-text m-0">Superficie C62 & C63 : 12a 15ca + 1ha 66a 74ca</p>
            <a href="#" id="6" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C62_63.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C633</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Casale</h6>
            <p class="card-text m-0">Superficie : 48ca</p>
            <a href="#" id="7" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C633.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C931</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Fontanacia</h6>
            <p class="card-text m-0">Superficie : 1a 39ca</p>
            <a href="#" id="8" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C931.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C1225</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Ernella</h6>
            <p class="card-text m-0">Superficie : 54ca</p>
            <a href="#" id="9" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C1225.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-2">
            <h5 class="card-title m-0">Parcelle C1228</h5>
            <h6 class="card-subtitle m-0 text-muted">Lieudit : Ernella</h6>
            <p class="card-text m-0">Superficie : 1a 00ca</p>
            <a href="#" id="10" class="card-link zoom">Zoomer sur la carte</a>
            <a href="C1228.gpx" class="card-link">Télécharger .GPX</a>
          </div>
        </div>
  
      </div> <!--End col-sm-3-->

      <div class="col-sm-9 div-map"> 
        <div id="map"></div> 
      </div>
      
    </div> <!--End row-->
    
  </body>

  <hr class="m-0">
    <footer>
      <div class="col-lg-12 p-3">
        <p class="small text-center m-0">
          Site réalisé par <strong>Thibault FIACRE </strong><span class="huge">&copy;</span> 2018 - 28 avenue Victor Hugo 26000 Valence - 06.84.86.83.94 - thibault.fiacre@gmail.com
        </p>
      </div>
    </footer>

    <script>

      var map;

      var A368;
      var B183;
      var B355_356;
      var B364;
      var C43;
      var C53;
      var C62_63;
      var C633;
      var C931;
      var C1225;
      var C1228;
      var tableauComplet;  
      var tableauParcelles;
      var tableauLong = [];
      var tableauLat = [];

      function initMap() {

        var url = "https://spreadsheets.google.com/feeds/cells/1Wqx8XiFVUMPYbr3BkuKN2cL3CXuEKV_RpTdG1EEs7nQ/od6/public/basic?alt=json";
        A368 = new google.maps.MVCArray();
        B183 = new google.maps.MVCArray();
        B355_356 = new google.maps.MVCArray();
        B364 = new google.maps.MVCArray();
        C43 = new google.maps.MVCArray();
        C53 = new google.maps.MVCArray();
        C62_63 = new google.maps.MVCArray();
        C633 = new google.maps.MVCArray();
        C931 = new google.maps.MVCArray();
        C1225 = new google.maps.MVCArray();
        C1228 = new google.maps.MVCArray();

        tableauAll = [];

        $.ajax({
          url:url,
          dataType:"jsonp",
          success:function(data) {              
            tableauComplet = data.feed.entry;
            
            tableauParcelles = tableauComplet.slice(12);

            for(var i=0; i<tableauParcelles.length; i++) {
              // console.log(tableauComplet[i].title.$t);
              if (tableauParcelles[i].title.$t.includes("H")) {
                tableauLong.push(tableauParcelles[i].content.$t)
              }
              if (tableauParcelles[i].title.$t.includes("I")) {
                tableauLat.push(tableauParcelles[i].content.$t)
              }
            }

            for(var j=0; j<=17; j++) {
              A368.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=18; j<=28; j++) {
              B183.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=30; j<=46; j++) {
              B355_356.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=47; j<=60; j++) {
              B364.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=61; j<=74; j++) {
              C43.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=75; j<=106; j++) {
              C53.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=108; j<=123; j++) {
              C62_63.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=124; j<=128; j++) {
              C633.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=129; j<=135; j++) {
              C931.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=136; j<=148; j++) {
              C1225.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }
            for(var j=149; j<=158; j++) {
              C1228.push(new google.maps.LatLng(parseFloat(tableauLat[j]), parseFloat(tableauLong[j])));
            }

            tableauAll = [
              A368.getArray()[0],
              B183.getArray()[0],
              B355_356.getArray()[0],
              B364.getArray()[0],
              C43.getArray()[0],
              C53.getArray()[0],
              C62_63.getArray()[0],
              C633.getArray()[0],
              C931.getArray()[0],
              C1225.getArray()[0],
              C1228.getArray()[0]
            ];

            map = new google.maps.Map(document.getElementById('map'), {
              center: {lat: 42.474348, lng: 9.045666},
              zoom: 14,
              mapTypeId: 'hybrid'
            });

            var A368Polygone = new google.maps.Polygon({
              paths: A368,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var A368Content = '<h5>Parcelle A368</h5>'
            var A368Info = new google.maps.InfoWindow({
              content: A368Content
            });
            var A368Marker = new google.maps.Marker({
              position: {lat: 42.49421799, lng: 9.05339673},
              map: map,
              title: "A368"
            });
            A368Marker.addListener('click', function() {
              A368Info.open(map, A368Marker);
            });
            A368Polygone.setMap(map);


            var B183Polygone = new google.maps.Polygon({
              paths: B183,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var B183Content = '<h5>Parcelle B183</h5>'
            var B183Info = new google.maps.InfoWindow({
              content: B183Content
            });
            var B183Marker = new google.maps.Marker({
              position: {lat: 42.46603408, lng: 9.05752920},
              map: map,
              title: "B183"
            });
            B183Marker.addListener('click', function() {
              B183Info.open(map, B183Marker);
            });
            B183Polygone.setMap(map);


            var B355_356Polygone = new google.maps.Polygon({
              paths: B355_356,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var B355_356Content = '<h5>Parcelle B355 & B356</h5>'
            var B355_356Info = new google.maps.InfoWindow({
              content: B355_356Content
            });
            var B355_356Marker = new google.maps.Marker({
              position: {lat: 42.46506674, lng: 9.05638853},
              map: map,
              title: "B355_356"
            });
            B355_356Marker.addListener('click', function() {
             B355_356Info.open(map, B355_356Marker);
            });
            B355_356Polygone.setMap(map);


            var B364Polygone = new google.maps.Polygon({
              paths: B364,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var B364Content = '<h5>Parcelle B364</h5>'
            var B364Info = new google.maps.InfoWindow({
              content: B364Content
            });
            var B364Marker = new google.maps.Marker({
              position: {lat: 42.46413604, lng: 9.05608749},
              map: map,
              title: "B364"
            });
            B364Marker.addListener('click', function() {
             B364Info.open(map, B364Marker);
            });
            B364Polygone.setMap(map);

            var C43Polygone = new google.maps.Polygon({
              paths: C43,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C43Content = '<h5>Parcelle C43</h5>'
            var C43Info = new google.maps.InfoWindow({
              content: C43Content
            });
            var C43Marker = new google.maps.Marker({
              position: {lat: 42.46618933, lng: 9.03195178},
              map: map,
              title: "C43"
            });
            C43Marker.addListener('click', function() {
             C43Info.open(map, C43Marker);
            });
            C43Polygone.setMap(map);

            var C53Polygone = new google.maps.Polygon({
              paths: C53,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C53Content = '<h5>Parcelle C53</h5>'
            var C53Info = new google.maps.InfoWindow({
              content: C53Content
            });
            var C53Marker = new google.maps.Marker({
              position: {lat: 42.46466354, lng: 9.03201396},
              map: map,
              title: "C53"
            });
            C53Marker.addListener('click', function() {
             C53Info.open(map, C53Marker);
            });
            C53Polygone.setMap(map);

            var C62_63Polygone = new google.maps.Polygon({
              paths: C62_63,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C62_63Content = '<h5>Parcelle C62 & 63</h5>'
            var C62_63Info = new google.maps.InfoWindow({
              content: C62_63Content
            });
            var C62_63Marker = new google.maps.Marker({
              position: {lat: 42.46366389, lng: 9.03230266},
              map: map,
              title: "C62_63"
            });
            C62_63Marker.addListener('click', function() {
             C62_63Info.open(map, C62_63Marker);
            });
            C62_63Polygone.setMap(map);

            var C633Polygone = new google.maps.Polygon({
              paths: C633,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C633Content = '<h5>Parcelle C633</h5>'
            var C633Info = new google.maps.InfoWindow({
              content: C633Content
            });
            var C633Marker = new google.maps.Marker({
              position: {lat: 42.45376080, lng: 9.03362365},
              map: map,
              title: "C633"
            });
            C633Marker.addListener('click', function() {
             C633Info.open(map, C633Marker);
            });
            C633Polygone.setMap(map);

            var C931Polygone = new google.maps.Polygon({
              paths: C931,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C931Content = '<h5>Parcelle C931</h5>'
            var C931Info = new google.maps.InfoWindow({
              content: C931Content
            });
            var C931Marker = new google.maps.Marker({
              position: {lat: 42.45182491, lng: 9.03278237},
              map: map,
              title: "C931"
            });
            C931Marker.addListener('click', function() {
             C931Info.open(map, C931Marker);
            });
            C931Polygone.setMap(map);

            var C1225Polygone = new google.maps.Polygon({
              paths: C1225,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C1225Content = '<h5>Parcelle C1225</h5>'
            var C1225Info = new google.maps.InfoWindow({
              content: C1225Content
            });
            var C1225Marker = new google.maps.Marker({
              position: {lat: 42.45886025, lng: 9.03277887},
              map: map,
              title: "C1225"
            });
            C1225Marker.addListener('click', function() {
             C1225Info.open(map, C1225Marker);
            });
            C1225Polygone.setMap(map);

            var C1228Polygone = new google.maps.Polygon({
              paths: C1228,
              strokeColor: '#FF0000',
              strokeOpacity: 1,
              strokeWeight: 2,
              fillColor: '#17A2B8',
              fillOpacity: 0.35
            });
            var C1228Content = '<h5>Parcelle C1228</h5>'
            var C1228Info = new google.maps.InfoWindow({
              content: C1228Content
            });
            var C1228Marker = new google.maps.Marker({
              position: {lat: 42.45878650, lng: 9.03265142},
              map: map,
              title: "C1228"
            });
            C1228Marker.addListener('click', function() {
             C1228Info.open(map, C1228Marker);
            });
            C1228Polygone.setMap(map);
          

          }, //End success
        }); //End ajax

        $(".zoom").each(function(index) {
          $(this).on("click", function(e) {
            e.preventDefault();
            var selection = $(this).attr("id");
            map.setCenter(tableauAll[selection]);
            if (selection < 7) {
              map.setZoom(17);
            } else {
              map.setZoom(20);
            }
          });
        });

      } //End initMap

    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAYDGo2_VK-fn1xFA2eOhdWURJZJ3q_UiE&callback=initMap" async defer></script>

</html>